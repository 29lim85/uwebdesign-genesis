var CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(t,n){var r=this.getPalette(t,5,n),o=r[0];return o},ColorThief.prototype.getPalette=function(t,n,r){"undefined"==typeof n&&(n=10),("undefined"==typeof r||1>r)&&(r=10);for(var o=new CanvasImage(t),e=o.getImageData(),a=e.data,i=o.getPixelCount(),u=[],s=0,c,f,v,h,l;i>s;s+=r)c=4*s,f=a[c+0],v=a[c+1],h=a[c+2],l=a[c+3],l>=125&&(f>250&&v>250&&h>250||u.push([f,v,h]));var p=MMCQ.quantize(u,n),m=p?p.palette():null;return o.removeCanvas(),m},!pv)var pv={map:function(t,n){var r={};return n?t.map(function(t,o){return r.index=o,n.call(r,t)}):t.slice()},naturalOrder:function(t,n){return n>t?-1:t>n?1:0},sum:function(t,n){var r={};return t.reduce(n?function(t,o,e){return r.index=e,t+n.call(r,o)}:function(t,n){return t+n},0)},max:function(t,n){return Math.max.apply(null,n?pv.map(t,n):t)}};var MMCQ=function(){function t(t,n,r){return(t<<2*s)+(n<<s)+r}function n(t){function n(){r.sort(t),o=!0}var r=[],o=!1;return{push:function(t){r.push(t),o=!1},peek:function(t){return o||n(),void 0===t&&(t=r.length-1),r[t]},pop:function(){return o||n(),r.pop()},size:function(){return r.length},map:function(t){return r.map(t)},debug:function(){return o||n(),r}}}function r(t,n,r,o,e,a,i){var u=this;u.r1=t,u.r2=n,u.g1=r,u.g2=o,u.b1=e,u.b2=a,u.histo=i}function o(){this.vboxes=new n(function(t,n){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),n.vbox.count()*n.vbox.volume())})}function e(n){var r=1<<3*s,o=new Array(r),e,a,i,u;return n.forEach(function(n){a=n[0]>>c,i=n[1]>>c,u=n[2]>>c,e=t(a,i,u),o[e]=(o[e]||0)+1}),o}function a(t,n){var o=1e6,e=0,a=1e6,i=0,u=1e6,s=0,f,v,h;return t.forEach(function(t){f=t[0]>>c,v=t[1]>>c,h=t[2]>>c,o>f?o=f:f>e&&(e=f),a>v?a=v:v>i&&(i=v),u>h?u=h:h>s&&(s=h)}),new r(o,e,a,i,u,s,n)}function i(n,r){function o(t){var n=t+"1",o=t+"2",e,a,i,u,h,l=0;for(v=r[n];v<=r[o];v++)if(c[v]>s/2){for(i=r.copy(),u=r.copy(),e=v-r[n],a=r[o]-v,h=a>=e?Math.min(r[o]-1,~~(v+a/2)):Math.max(r[n],~~(v-1-e/2));!c[h];)h++;for(l=f[h];!l&&c[h-1];)l=f[--h];return i[o]=h,u[n]=i[o]+1,[i,u]}}if(r.count()){var e=r.r2-r.r1+1,a=r.g2-r.g1+1,i=r.b2-r.b1+1,u=pv.max([e,a,i]);if(1==r.count())return[r.copy()];var s=0,c=[],f=[],v,h,l,p,m;if(u==e)for(v=r.r1;v<=r.r2;v++){for(p=0,h=r.g1;h<=r.g2;h++)for(l=r.b1;l<=r.b2;l++)m=t(v,h,l),p+=n[m]||0;s+=p,c[v]=s}else if(u==a)for(v=r.g1;v<=r.g2;v++){for(p=0,h=r.r1;h<=r.r2;h++)for(l=r.b1;l<=r.b2;l++)m=t(h,v,l),p+=n[m]||0;s+=p,c[v]=s}else for(v=r.b1;v<=r.b2;v++){for(p=0,h=r.r1;h<=r.r2;h++)for(l=r.g1;l<=r.g2;l++)m=t(h,l,v),p+=n[m]||0;s+=p,c[v]=s}return c.forEach(function(t,n){f[n]=s-t}),o(u==e?"r":u==a?"g":"b")}}function u(t,r){function u(t,n){for(var r=1,o=0,e;f>o;)if(e=t.pop(),e.count()){var a=i(c,e),u=a[0],s=a[1];if(!u)return;if(t.push(u),s&&(t.push(s),r++),r>=n)return;if(o++>f)return}else t.push(e),o++}if(!t.length||2>r||r>256)return!1;var c=e(t),h=1<<3*s,l=0;c.forEach(function(){l++});var p=a(t,c),m=new n(function(t,n){return pv.naturalOrder(t.count(),n.count())});m.push(p),u(m,v*r);for(var g=new n(function(t,n){return pv.naturalOrder(t.count()*t.volume(),n.count()*n.volume())});m.size();)g.push(m.pop());u(g,r-g.size());for(var d=new o;g.size();)d.push(g.pop());return d}var s=5,c=8-s,f=1e3,v=.75;return r.prototype={volume:function(t){var n=this;return n._volume&&!t||(n._volume=(n.r2-n.r1+1)*(n.g2-n.g1+1)*(n.b2-n.b1+1)),n._volume},count:function(n){var r=this,o=r.histo;if(!r._count_set||n){var e=0,a,i,u;for(a=r.r1;a<=r.r2;a++)for(i=r.g1;i<=r.g2;i++)for(u=r.b1;u<=r.b2;u++)index=t(a,i,u),e+=o[index]||0;r._count=e,r._count_set=!0}return r._count},copy:function(){var t=this;return new r(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(n){var r=this,o=r.histo;if(!r._avg||n){var e=0,a=1<<8-s,i=0,u=0,c=0,f,v,h,l,p;for(v=r.r1;v<=r.r2;v++)for(h=r.g1;h<=r.g2;h++)for(l=r.b1;l<=r.b2;l++)p=t(v,h,l),f=o[p]||0,e+=f,i+=f*(v+.5)*a,u+=f*(h+.5)*a,c+=f*(l+.5)*a;e?r._avg=[~~(i/e),~~(u/e),~~(c/e)]:r._avg=[~~(a*(r.r1+r.r2+1)/2),~~(a*(r.g1+r.g2+1)/2),~~(a*(r.b1+r.b2+1)/2)]}return r._avg},contains:function(t){var n=this,r=t[0]>>c;return gval=t[1]>>c,bval=t[2]>>c,r>=n.r1&&r<=n.r2&&gval>=n.g1&&gval<=n.g2&&bval>=n.b1&&bval<=n.b2}},o.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var n=this.vboxes,r=0;r<n.size();r++)if(n.peek(r).vbox.contains(t))return n.peek(r).color;return this.nearest(t)},nearest:function(t){for(var n=this.vboxes,r,o,e,a=0;a<n.size();a++)o=Math.sqrt(Math.pow(t[0]-n.peek(a).color[0],2)+Math.pow(t[1]-n.peek(a).color[1],2)+Math.pow(t[2]-n.peek(a).color[2],2)),(r>o||void 0===r)&&(r=o,e=n.peek(a).color);return e},forcebw:function(){var t=this.vboxes;t.sort(function(t,n){return pv.naturalOrder(pv.sum(t.color),pv.sum(n.color))});var n=t[0].color;n[0]<5&&n[1]<5&&n[2]<5&&(t[0].color=[0,0,0]);var r=t.length-1,o=t[r].color;o[0]>251&&o[1]>251&&o[2]>251&&(t[r].color=[255,255,255])}},{quantize:u}}();jQuery(window).load(function(){if(document.getElementsByClassName("entry-image").length>0){var t=new ColorThief;i=0,jQuery(".entry-header").each(function(){dominantColors=t.getPalette(document.getElementsByClassName("entry-image")[i],8),jmax=jmin=dominantColors[0];for(var n=0;n<dominantColors.length;n++)jsum=dominantColors[n][0]+dominantColors[n][1]+dominantColors[n][2],jsum<parseInt(jmin[0]+jmin[1]+jmin[2])&&(jmin=dominantColors[n]),jsum>parseInt(jmax[0]+jmax[1]+jmax[2])&&(jmax=dominantColors[n]);jQuery(this).css("background-color","rgb("+jmin[0]+","+jmin[1]+","+jmin[2]+")"),jQuery(this).css("color","rgb("+jmax[0]+","+jmax[1]+","+jmax[2]+")"),jQuery("a",this).css("color","rgb("+jmax[0]+","+jmax[1]+","+jmax[2]+")"),i++})}});